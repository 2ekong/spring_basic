<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>RESTful API Test</title>
<script type="text/javascript">

function func1() {
    // alert("a");
    fetch("/hipost", {method:"POST"})
        .then(response => {
            if (!response.ok) {
                throw new Error("response 오류");
            }
            return response.text();
        })
        .then(data => {
            document.querySelector("#result").innerText = data;
        })
        .catch(error => {
            document.querySelector("#result").innerText = "error: " + error;
        })
}

function func2() {
    const name = document.querySelector("#nameinput2").value;
    const addr = document.querySelector("#addrinput2").value;

    fetch("/hiform", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded"
        },
        body: `name=${encodeURIComponent(name)}&addr=${encodeURIComponent(addr)}`
    })
    .then(response => {
        if (!response.ok) throw new Error("response 오류");
        return response.text();
    })
    .then(data => {
        document.querySelector("#result").innerText = data;
    })
    .catch(error => {
        document.querySelector("#result").innerText = "error: " + error;
    });
}

function func3(event) {
	event.preventDefault();

	const formData = new FormData(document.querySelector("#frm"));

	fetch("/hiform3", {
		method: "POST",
		body: formData
	})
	.then(response => {
		if (!response.ok) throw new Error("response 오류");
		return response.text();
	})
	.then(data => {
		document.querySelector("#result").innerText = data;
	})
	.catch(error => {
		document.querySelector("#result").innerText = "error : " + error;
	});
}


function func4(event) {
	event.preventDefault();

	const name = document.querySelector("#jsonNameInput").value;
	const addr = document.querySelector("#jsonAddrInput").value;

	const jsonData = {
		name: name,
		addr: addr
	};

	fetch("/hiform2", {
		method: "POST",
		headers: {
			"Content-Type": "application/json"
		},
		body: JSON.stringify(jsonData)
	})
	.then(response => {
		if (!response.ok) throw new Error("response 오류");
		return response.text();
	})
	.then(data => {
		document.querySelector("#result").innerText = data;
	})
	.catch(error => {
		document.querySelector("#result").innerText = "error: " + error;
	})
}


</script>
</head>
<body>
<h2>RESTful API test</h2>

<button onclick="func1()">post요청1</button><br><br>

<input type="text" id="nameinput2" value="홍길동" placeholder="이름 입력">
<input type="text" id="addrinput2" value="강남구 테헤란로" placeholder="주소 입력">
<button onclick="func2()">post요청2</button><br><br>


<form id="frm" onsubmit="func3(event)">
	<input type="text" name="name" value="고길동" placeholder="이름 입력">
	<input type="text" name="addr" value="강남구 역삼1동" placeholder="주소 입력">
	<button type="submit">post요청3</button>
</form>
<br>
<form id="jsonfrm" onsubmit="func4(event)">
    <input type="text" id="jsonNameInput" placeholder="이름" value="홍홍홍">
    <input type="text" id="jsonAddrInput" placeholder="주소" value="홍홍나라">
    <button type="submit">POST 요청4(json data)</button>
</form>

<hr>
<div id="result"></div>
</body>
</html>