<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>상품 정보 조회</title>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script type="text/javascript">
window.onload = function() {
    document.querySelector("#btnShow").onclick = function() {
        fetch("sangpums")
            .then(response => {
                if (!response.ok) {
                    throw new Error("response was not ok");
                }
                return response.json();
            })
            .then(data => { 
                let str = "";
                let sdatas = data.datas; 

                $(sdatas).each(function(index, arr){
                    str += "<tr>";
                    str += "<td>" + arr["code"] + "</td>";
                    str += "<td>" + arr["sang"] + "</td>";
                    str += "<td>" + arr["su"] + "</td>";
                    str += "<td>" + arr["dan"] + "</td>";
                    str += "</tr>";
                });

                $("tbody").append(str); 
            })
            .catch((error) => { 
                document.querySelector("#showErr").innerHTML = "<b>에러 발생: " + error + "</b>";
            });
    };
};

</script>
</head>
<body>
<h2>상품 정보(@MVC + fetch)</h2>
<button id="btnShow">상품 보기</button>
<table>
    <thead>
        <tr><th>코드</th><th>품명</th><th>수량</th><th>단가</th></tr>
    </thead>
    <tbody>
    </tbody>
</table>
<br>
<div id="showErr" ></div>
</body>
</html>
